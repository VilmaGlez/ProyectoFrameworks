<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cursoDAgil.bd.mappers.ClienteMapper">
  <resultMap id="BaseResultMap" type="cursoDAgil.bd.domain.Cliente">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 12 18:04:40 CST 2019.
    -->
    
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="nombre" jdbcType="VARCHAR" property="nombre" />
    <result column="apellido" jdbcType="VARCHAR" property="apellido" />
    <result column="email" jdbcType="VARCHAR" property="email" />
    <result column="sexo" jdbcType="VARCHAR" property="sexo" />
    <result column="idDireccion" jdbcType="INTEGER" property="idDireccion" />
  </resultMap>
  
  <resultMap id="ResultClienteDireccion" type="cursoDAgil.bd.domain.Cliente">
  	<id column="id" jdbcType="INTEGER" property="id" />
    <result column="nombre" jdbcType="VARCHAR" property="nombre" />
    <result column="apellido" jdbcType="VARCHAR" property="apellido" />
    <result column="email" jdbcType="VARCHAR" property="email" />
    <result column="sexo" jdbcType="VARCHAR" property="sexo" />
    <result column="idDireccion" jdbcType="INTEGER" property="idDireccion" />
    <association property="direccion" column="idDireccion" resultMap="DireccionResultMap"/>
  	
  </resultMap>
  
  <resultMap id="DireccionResultMap" type="cursoDAgil.bd.domain.Direccion">
  	<id column="idDireccion" property="idDireccion" />
    <result column="calle"   property="calle" />
    <result column="numero"  property="numero" />
    <result column="colonia"  property="colonia" />
    <result column="ciudad"  property="ciudad" />
    <result column="estado"  property="estado" />	
    <result column="pais"  property="pais" />
    <result column="codigoPostal"  property="codigoPostal" />
  </resultMap>
  
  <select id="listarTodosClientes" resultMap="ResultClienteDireccion">
  		select 
  		cli.id,
  		cli.nombre,
  		cli.apellido,
  		cli.email,
  		cli.sexo,
  		cli.idDireccion,
  		d.idDireccion,
  		d.calle,
  		d.numero,
  		d.colonia,
  		d.ciudad,
  		d.estado,
  		d.pais,
  		d.codigoPostal
  		from equipo4.cliente cli
  		inner join direccion as d on cli.idDireccion = d.idDireccion
    </select>
    
    <insert id="nuevoCliente"
  parameterType="cursoDAgil.bd.domain.Cliente"
  				useGeneratedKeys="true" keyProperty="id">
  				insert into cliente(nombre,apellido,email,sexo,idDireccion)
  				values (#{nombre}, #{apellido}, #{email}, #{sexo}, #{direccion.idDireccion})
  				
  </insert> 
  
  <select id="obtenerClientePorId" resultMap="ResultClienteDireccion"
  		parameterType="Integer">
  		select 
  		cli.id,
  		cli.nombre,
  		cli.apellido,
  		cli.email,
  		cli.sexo,
  		cli.idDireccion,
  		dir.idDireccion,
  		dir.calle,
  		dir.numero,
  		dir.colonia,
  		dir.ciudad,
  		dir.estado,
  		dir.pais,
  		dir.codigoPostal
  		from equipo4.cliente cli
  		inner join direccion as dir on cli.idDireccion = dir.idDireccion
  		where
		cli.id = #{id}
  		
  		</select>
  		
  	<delete id="eliminarCliente" parameterType="int">
  	delete from cliente where id = #{id}
  	</delete>
  	
  	<update id="modificarCliente" parameterType="cursoDAgil.bd.domain.Cliente"
  	useGeneratedKeys="true" keyProperty="id">
  	update cliente set 
  	nombre = #{nombre},
  	apellido = #{apellido},
  	email = #{email},
  	sexo = #{sexo},
  	idDireccion = #{direccion.idDireccion}
  	where id = #{id};

  	</update>
  
</mapper>
